- clean: ['~']

- shell:
  - [sh macos, Setting up osx]
  - [git submodule update --init --recursive, Installing submodules]
  -
    command: echo Running pre installation script && sh pre-install.sh
    stdout: true

  - [mkdir -p ~/.config/nvim, Creating nvim folders]
  - [mkdir -p ~/.config/nvim/ultisnips, Creating nvim folders]
  - [mkdir -p ~/.config/oni, Creating oni folders]

- link:
    # Terminal:
    ~/.shell:
      path: shell
      create: true
    ~/.shell_env: config/shell_env
    ~/.profile: config/profile
    ~/.bash_profile: config/bash_profile
    ~/.bashrc: config/bashrc
    ~/.zshrc: config/zshrc
    ~/.agignore: config/agignore

    # Git:
    ~/.gitconfig: config/gitconfig
    ~/.gitignore: config/gitignore
    ~/.gitignore_global: config/gitignore_global

    # Editors:
    ~/.editorconfig: config/editorconfig

    # Neovim
    ~/.config/nvim/init.vim: config/init.vim
    ~/.config/nvim/commands.vim: config/nvim/commands.vim
    ~/.config/nvim/config.vim: config/nvim/config.vim
    ~/.config/nvim/functions.vim: config/nvim/functions.vim
    ~/.config/nvim/keymap.vim: config/nvim/keymap.vim
    ~/.config/nvim/macros.vim: config/nvim/macros.vim
    ~/.config/nvim/plugins.vim: config/nvim/plugins.vim

    ~/.config/nvim/ultisnips/30secondsofcode.snippets: config/nvim/ultisnips/30secondsofcode.snippets
    ~/.config/nvim/ultisnips/html.snippets: config/nvim/ultisnips/html.snippets
    ~/.config/nvim/ultisnips/javascript.snippets: config/nvim/ultisnips/javascript.snippets
    ~/.config/nvim/ultisnips/typescript.snippets: config/nvim/ultisnips/typescript.snippets
    ~/.config/nvim/ultisnips/typescriptreact.snippets: config/nvim/ultisnips/typescriptreact.snippets

    # Oni
    ~/.config/oni/config.js: config/oni/config.js
    ~/.config/oni/config.tsx: config/oni/config.tsx
    ~/.config/oni/tsconfig.json: config/oni/tsconfig.json

- shell:
  -
    command: echo Installing Homebrew formulas from Brewfile && brew bundle
    stdout: true

- pip:
    file: python/requirements.txt
    binary: /usr/local/opt/python/libexec/bin/pip

- pip:
    file: python/requirements3.txt
    binary: /usr/local/bin/pip3

- pipsi:
    file: python/requirements-pipsi.txt

- shell:
  - [if ! hash bundle 2>/dev/null; then gem install bundler; fi, Installing Bundler]
  - [bundle install, Installing system gems from Gemfile]

- shell:
  -
    command: echo Installing vim plugins && nvim +PluginInstall +qall
    stdout: true

# These links should be created after everything is installed:
- shell:
  - [brew cleanup, Cleaning up]

